#!/bin/bash
set -euo pipefail
IFS=$'\n\t'

# Pre-commit hook para executar verifica√ß√µes de qualidade
# Este hook executa shellcheck e shfmt antes de permitir o commit

# Se houver altera√ß√£o nesse arquivo, execute "make install-hooks" para atualizar o hook.

echo "üîç Executando verifica√ß√µes de qualidade..."
echo ""

# Executar shellcheck
echo "üìã ShellCheck..."
if ! make shellcheck 2>&1 | grep -v "^make\["; then
    echo ""
    echo "‚ùå ShellCheck falhou! Corrija os erros antes de commitar."
    exit 1
fi

echo ""

# Executar shfmt
echo "üìã shfmt..."
if ! make shfmt 2>&1 | grep -v "^make\["; then
    echo ""
    echo "‚ùå Formata√ß√£o incorreta! Execute 'make format' e tente novamente."
    exit 1
fi

echo ""
echo "‚úÖ Todas as verifica√ß√µes passaram!"
echo ""

exit 0
